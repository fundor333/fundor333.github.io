---
title: "Letterhead With ReportLab"
date: 2021-05-03T09:12:14+02:00

featured: "Letterhead-with-ReportLab.jpg"
feature_link: "https://unsplash.com/photos/XtDKGqK3uaA"
feature_text: "Photo by Mae Mu on Unsplash"
tags:
- coding
- python
- reportlab
- pdf
categories:
- dev
- fingerfood
slug: "Letterhead-with-ReportLab"
description: "Sometime you need to have a letterhead document generated by your application and here we explain how to make it with Reportlab"
type: "post"
---

Sometime you need to make some pdf looking more professional. 
In python you use the ReportLab[^1] package for make Pdf.
[^1]: [ReportLab](https://www.reportlab.com/opensource/) is an opensource engine for Pdf documents. The python package is [here](https://www.reportlab.com/dev/docs/)

## Fist the main core

For every document type I need I write a class with a _get_pdf_ for _print_[^2] a Pdf.
[^2]: I use print for the action of making a Pdf from some data (like a json, a csv or a datasource of other type)
If one ore more of this Pdf's types have a common layout (like a letterhead) I make an parent object for the type of document and call it _SomethingPrinter_.

Here an example[^3]
[^3]: My default paper is _A4_ but you can import any format from _reportlab.lib.pagesizes_ or define a new one following this format _A4 = (210*mm,297*mm)_

``` python
class BasicPrinter:
    def __init__(self, buffer, pagesize="A4"):
        self.buffer = buffer
        if pagesize == "A4":
            self.pagesize = A4
        elif pagesize == "Letter":
            self.pagesize = letter
        else:
            self.pagesize = A4
        self.width, self.height = self.pagesize

    @staticmethod
    def _header_footer(canvas, doc):
        BasicPrinter.header(canvas, doc)
        BasicPrinter.footer(canvas, doc)

        canvas.saveState()
        canvas.restoreState()

    @staticmethod
    def header(canvas, doc):
        canvas.saveState()
        header = Image("letterhead_header.jpg", 600, 60)
        header.drawOn(
            canvas, doc.leftMargin - 2 * cm, doc.height + doc.topMargin + 2 * cm
        )
        canvas.restoreState()

    @staticmethod
    def footer(canvas, doc):
        canvas.saveState()
        footer = Image("letterhead_footer.jpg", 600, 60)
        w, h = footer.wrap(doc.width, doc.bottomMargin)
        footer.drawOn(canvas, doc.leftMargin - 2 * cm, h - 2 * cm)
        canvas.restoreState()
```

The real important things are the _footer_ and _header_ function (in our case staticmethod). In each one we add a img (the footer or header) with all the logos and company info in it. If you want you can put the info as text yourself. Remember to save and restore alwayse the canvas because sometime, if you don't do it can launch error.

## The specific printer (or how to use the main core)

After you have done you need to make a "_printer_" for your document. In this case is a booring paper about Privacy.

``` python
class PrivacyPaperPrinter(BasicPrinter):
    @staticmethod
    def _header_footer(canvas, doc):
        # Save the state of our canvas so we can draw on it 
        PrivacyPaperPrinter.header(canvas, doc)
        PrivacyPaperPrinter.footer(canvas, doc)

    def get_pdf(self):
        buffer = self.buffer
		styles = getSampleStyleSheet()
        doc = SimpleDocTemplate(buffer)

        elements = []
        elements.append(Paragraph("My boring Privacy Paper", style=styles["Title"]))
        elements.append(Paragraph("Lorem ipsum dolor sit amet, consectetur adipiscing elit. Morbi sed sem ornare, dictum sapien at, egestas sapien. Nullam faucibus eleifend finibus. Vivamus vel sapien urna.", style=styles["Normal"]))
        doc.build(elements, onFirstPage=self._header_footer, onLaterPages=self._header_footer)

        pdf = buffer.getvalue()
        buffer.close()
        return pdf
```

This class extend the previus one and fill the buffer with al the relevant info and other element of the document (like titles, paragraphs, tables and images).

For the way I set up this class you have all the page with the letterhead template. This is happening because I setup the _onFirstPage_ which will be call on the first page and the _onLaterPages_ which will be call from page two  with the call for the _header_ and the _footer_ function.
